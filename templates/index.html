<!DOCTYPE html>
<html>
<head>
    <!-- Keep your existing styles -->
    <title>Network Visualization</title>
    <script src="https://unpkg.com/neovis.js@2.0.2"></script>
    <!-- Add your existing styles here -->
</head>
<body>
    <div class="filter-tabs">
        <button class="tab-button active" data-tab="node-types">Node Types</button>
        <button class="tab-button" data-tab="locations">Locations</button>
    </div>

    <div id="node-types" class="filter-section active">
        <div class="filter-container">
            <div class="filter-group">
                <div class="filter-group-title">
                    <h3>Node Types</h3>
                    <button class="clear-btn" id="clearNodeTypes">Clear</button>
                </div>
                <div class="filter-buttons" id="nodeTypeFilters">
                    <!-- Keep your existing buttons -->
                </div>
            </div>
        </div>
        <div class="filter-stats" id="nodeTypeStats"></div>
    </div>

    <div id="locations" class="filter-section">
        <div class="filter-container" id="locationGroups"></div>
        <div class="filter-stats" id="locationStats"></div>
    </div>

    <script>
        class FilterManager {
            constructor() {
                this.activeNodeTypes = new Set();
                this.activeLocations = new Set();
                this.activeSublocations = new Set();
                this.initializeTabs();
                this.initializeEventListeners();
                this.initializeLocationGroups();
                this.updateStats();
            }

            initializeEventListeners() {
                // Add event listeners for node type buttons
                const nodeTypeButtons = document.querySelectorAll('#nodeTypeFilters .filter-btn');
                nodeTypeButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        const type = button.getAttribute('data-type');
                        if (button.classList.contains('active')) {
                            this.activeNodeTypes.delete(type);
                            button.classList.remove('active');
                        } else {
                            this.activeNodeTypes.add(type);
                            button.classList.add('active');
                        }
                        this.updateStats();
                        this.updateVisualization();
                    });
                });

                // Add event listener for clear button
                document.getElementById('clearNodeTypes').addEventListener('click', () => {
                    this.clearNodeTypes();
                });
            }

            toggleNodeType(button) {
                const type = button.getAttribute('data-type');
                if (button.classList.contains('active')) {
                    this.activeNodeTypes.delete(type);
                    button.classList.remove('active');
                } else {
                    this.activeNodeTypes.add(type);
                    button.classList.add('active');
                }
                this.updateStats();
                this.updateVisualization();
            }

            clearNodeTypes() {
                this.activeNodeTypes.clear();
                document.querySelectorAll('#nodeTypeFilters .filter-btn').forEach(button => {
                    button.classList.remove('active');
                });
                this.updateStats();
                this.updateVisualization();
            }

            updateStats() {
                document.getElementById('nodeTypeStats').textContent = 
                    `${this.activeNodeTypes.size} node types selected`;
                document.getElementById('locationStats').textContent = 
                    `${this.activeSublocations.size} locations selected`;
            }

            updateVisualization() {
                const filters = {
                    nodeTypes: Array.from(this.activeNodeTypes),
                    locations: Array.from(this.activeLocations),
                    sublocations: Array.from(this.activeSublocations)
                };
                console.log('Active filters:', filters);
                // Add your visualization update logic here
            }

            // Keep your existing methods for locations
        }

        // Initialize the filter manager when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            window.filterManager = new FilterManager();
        });
    </script>
</body>
</html>
