
<!DOCTYPE html>
<html>
<head>
    <style>
        .filter-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            border-bottom: 1px solid #404040;
            padding: 0 20px;
        }

        .tab-button {
            padding: 10px 20px;
            background: #2a2a2a;
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 8px 8px 0 0;
        }

        .tab-button.active {
            background: #404040;
        }

        .filter-section {
            padding: 20px;
            background: #1a1a1a;
            display: none;
        }

        .filter-section.active {
            display: block;
        }

        .filter-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }

        .filter-group {
            background: #2a2a2a;
            padding: 15px;
            border-radius: 8px;
            min-width: 200px;
        }

        .filter-group-title {
            color: white;
            margin: 0 0 10px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .filter-btn {
            padding: 6px 12px;
            border: 1px solid #404040;
            border-radius: 15px;
            background: transparent;
            color: white;
            cursor: pointer;
            margin: 4px;
            transition: all 0.2s;
        }

        .filter-btn:hover {
            background: #404040;
        }

        .filter-btn.active {
            background: #606060;
            border-color: #808080;
        }

        .clear-btn {
            padding: 4px 8px;
            border: 1px solid #ff4444;
            border-radius: 12px;
            background: transparent;
            color: #ff4444;
            cursor: pointer;
            font-size: 12px;
        }

        .clear-btn:hover {
            background: #ff4444;
            color: white;
        }

        .filter-stats {
            color: #808080;
            font-size: 14px;
            padding: 10px 20px;
        }
    </style>
</head>
<body>
    <div class="filter-tabs">
        <button class="tab-button active" data-tab="node-types">Node Types</button>
        <button class="tab-button" data-tab="locations">Locations</button>
    </div>

    <div id="node-types" class="filter-section active">
        <div class="filter-container">
            <div class="filter-group">
                <div class="filter-group-title">
                    <h3>Node Types</h3>
                    <button class="clear-btn" onclick="clearNodeTypes()">Clear</button>
                </div>
                <div class="filter-buttons">
                    <button class="filter-btn" data-type="nerve">nerve</button>
                    <button class="filter-btn" data-type="bone">bone</button>
                    <button class="filter-btn" data-type="neuro">neuro</button>
                    <button class="filter-btn" data-type="region">region</button>
                    <button class="filter-btn" data-type="viscera">viscera</button>
                    <button class="filter-btn" data-type="muscle">muscle</button>
                    <button class="filter-btn" data-type="sense">sense</button>
                    <button class="filter-btn" data-type="vein">vein</button>
                    <button class="filter-btn" data-type="artery">artery</button>
                    <button class="filter-btn" data-type="cv">cv</button>
                    <button class="filter-btn" data-type="function">function</button>
                    <button class="filter-btn" data-type="sensory">sensory</button>
                    <button class="filter-btn" data-type="gland">gland</button>
                    <button class="filter-btn" data-type="lymph">lymph</button>
                    <button class="filter-btn" data-type="head">head</button>
                    <button class="filter-btn" data-type="organ">organ</button>
                    <button class="filter-btn" data-type="sensation">sensation</button>
                    <button class="filter-btn" data-type="skin">skin</button>
                </div>
            </div>
        </div>
        <div class="filter-stats" id="nodeTypeStats"></div>
    </div>

    <div id="locations" class="filter-section">
        <div class="filter-container" id="locationGroups">
            <!-- Location groups will be inserted here by JavaScript -->
        </div>
        <div class="filter-stats" id="locationStats"></div>
    </div>

    <script>
        const locationData = {
            'head': ['brain', 'eye', 'face', 'ear', 'nose', 'skull', 'mouth', 'head'],
            'neck': ['cervical spine', 'visceral', 'vascular'],
            'upper limb': ['wrist', 'hand', 'fingers', 'arm', 'forearm', 'elbow', 'shoulder'],
            'thorax': ['thoracic spine', 'ribcage', 'heart', 'lung'],
            'abdomen': ['lumbar spine', 'right upper quadrant', 'left upper quadrant', 'right lower quadrant', 'left lower quadrant'],
            'spine': ['spinal cord', 'vertebral', 'tracts', 'sacral spine'],
            'pelvis': ['sacral spine', 'greater pelvis', 'lesser pelvis'],
            'lower limb': ['foot', 'thigh', 'knee', 'leg', 'ankle', 'toes']
        };

        class FilterManager {
            constructor() {
                this.activeNodeTypes = new Set();
                this.activeLocations = new Set();
                this.activeSublocations = new Set();
                this.initializeTabs();
                this.initializeLocationGroups();
                this.initializeEventListeners();
                this.updateStats();
            }

            initializeTabs() {
                document.querySelectorAll('.tab-button').forEach(button => {
                    button.addEventListener('click', () => {
                        document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
                        document.querySelectorAll('.filter-section').forEach(s => s.classList.remove('active'));
                        button.classList.add('active');
                        document.getElementById(button.dataset.tab).classList.add('active');
                    });
                });
            }

            initializeLocationGroups() {
                const container = document.getElementById('locationGroups');
                Object.entries(locationData).forEach(([location, sublocations]) => {
                    const group = document.createElement('div');
                    group.className = 'filter-group';
                    
                    const header = document.createElement('div');
                    header.className = 'filter-group-title';
                    header.innerHTML = `
                        <h3>${location}</h3>
                        <button class="clear-btn" onclick="filterManager.clearLocationGroup('${location}')">Clear</button>
                    `;
                    
                    const buttons = document.createElement('div');
                    buttons.className = 'filter-buttons';
                    
                    sublocations.forEach(sublocation => {
                        const button = document.createElement('button');
                        button.className = 'filter-btn';
                        button.setAttribute('data-location', location);
                        button.setAttribute('data-sublocation', sublocation);
                        button.textContent = sublocation;
                        buttons.appendChild(button);
                    });
                    
                    group.appendChild(header);
                    group.appendChild(buttons);
                    container.appendChild(group);
                });
            }

            initializeEventListeners() {
                // Node type filters
                document.querySelectorAll('#node-types .filter-btn').forEach(button => {
                    button.addEventListener('click', () => this.toggleNodeType(button));
                });

                // Location filters
                document.querySelectorAll('#locations .filter-btn').forEach(button => {
                    button.addEventListener('click', () => this.toggleSublocation(button));
                });
            }

            toggleNodeType(button) {
                const nodeType = button.dataset.type;
                if (button.classList.contains('active')) {
                    this.activeNodeTypes.delete(nodeType);
                    button.classList.remove('active');
                } else {
                    this.activeNodeTypes.add(nodeType);
                    button.classList.add('active');
                }
                this.updateVisualization();
                this.updateStats();
            }

            toggleSublocation(button) {
                const location = button.dataset.location;
                const sublocation = button.dataset.sublocation;
                if (button.classList.contains('active')) {
                    this.activeLocations.delete(location);
                    this.activeSublocations.delete(sublocation);
                    button.classList.remove('active');
                } else {
                    this.activeLocations.add(location);
                    this.activeSublocations.add(sublocation);
                    button.classList.add('active');
                }
                this.updateVisualization();
                this.updateStats();
            }

            clearNodeTypes() {
                this.activeNodeTypes.clear();
                document.querySelectorAll('#node-types .filter-btn').forEach(button => {
                    button.classList.remove('active');
                });
                this.updateVisualization();
                this.updateStats();
            }

            clearLocationGroup(location) {
                document.querySelectorAll(`[data-location="${location}"]`).forEach(button => {
                    this.activeSublocations.delete(button.dataset.sublocation);
                    button.classList.remove('active');
                });
                this.activeLocations.delete(location);
                this.updateVisualization();
                this.updateStats();
            }

            updateStats() {
                document.getElementById('nodeTypeStats').textContent = 
                    `${this.activeNodeTypes.size} node types selected`;
                document.getElementById('locationStats').textContent = 
                    `${this.activeSublocations.size} locations selected`;
            }

            updateVisualization() {
                const filters = {
                    nodeTypes: Array.from(this.activeNodeTypes),
                    locations: Array.from(this.activeLocations),
                    sublocations: Array.from(this.activeSublocations)
                };
                
                // This should be implemented based on your visualization library
                console.log('Active filters:', filters);
                
                // Example implementation for D3.js:
                /*
                d3.selectAll('.node')
                    .style('opacity', d => {
                        const matchesType = filters.nodeTypes.length === 0 || 
                            filters.nodeTypes.includes(d.type);
                        const matchesLocation = filters.sublocations.length === 0 || 
                            filters.sublocations.includes(d.location);
                        return (matchesType && matchesLocation) ? 1 : 0.2;
                    });
                */
            }
        }

        // Initialize the filter manager
        const filterManager = new FilterManager();

        // Global functions for HTML onclick handlers
        function clearNodeTypes() {
            filterManager.clearNodeTypes();
        }
    </script>
</body>
</html>
